"use strict";(self.webpackChunkngrx_example_app=self.webpackChunkngrx_example_app||[]).push([[467],{2467:(xt,L,a)=>{a.r(L),a.d(L,{AtomicStateExampleModule:()=>Lt});var I=a(6895),j=a(5861),s=a(9653);const y=(0,s.PH)("[Friends API] Load Success",(0,s.Ky)()),A=(0,s.PH)("[Friends API] Load Failure",(0,s.Ky)()),v=(0,s.PH)("[Friends API] Add Friend Success",(0,s.Ky)()),P=(0,s.PH)("[Friends API] Add Friend Failure",(0,s.Ky)()),x="[Atomic State Example Page]",S=(0,s.PH)(`${x} Enter`),E=(0,s.PH)(`${x} Friend Added`,(0,s.Ky)());var i=(()=>{return(t=i||(i={})).INIT="INIT",t.LOADING="LOADING",t.LOADING_MORE="LOADING_MORE",t.PROCESSING="PROCESSING",t.RESOLVED="RESOLVED",t.FAILED="FAILED",t.REJECTED="REJECTED",t.STOPPING="STOPPING",t.STOPPED="STOPPED",i;var t})(),z=a(4629);const O="friends",g=function w(t){const n=(0,z.H)(t),o=function X(){return{getSelectors:function t(n){const o=r=>r.ids,c=r=>r.entities,l=(0,s.P1)(o,c,(r,yt)=>r.map(vt=>yt[vt])),u=(0,s.P1)(o,r=>r.length),f=r=>r.requestState===i.INIT,D=r=>r.requestState===i.LOADING,$=r=>r.requestState===i.LOADING_MORE,R=r=>r.requestState===i.LOADING||r.requestState===i.LOADING_MORE,Z=r=>r.requestState===i.PROCESSING,H=r=>r.requestState===i.RESOLVED,U=r=>r.requestState===i.FAILED,J=r=>r.requestState===i.REJECTED,K=r=>r.requestState===i.STOPPING,Y=r=>r.requestState===i.STOPPED,h=(0,s.P1)(o,r=>null!==r&&r.length>0),B=(0,s.P1)(h,r=>!r),Q=r=>!(!r.requestState.errorMsg&&!r.requestState.errorCode),V=r=>r.requestState.errorMsg,W=r=>r.requestState.errorCode;return n?{selectIds:(0,s.P1)(n,o),selectEntities:(0,s.P1)(n,c),selectAll:(0,s.P1)(n,l),selectTotal:(0,s.P1)(n,u),selectIsInit:(0,s.P1)(n,f),selectIsLoading:(0,s.P1)(n,D),selectIsLoadingMore:(0,s.P1)(n,$),selectIsLoadingOrLoadingMore:(0,s.P1)(n,R),selectIsProcessing:(0,s.P1)(n,Z),selectIsResolved:(0,s.P1)(n,H),selectIsFailed:(0,s.P1)(n,U),selectIsRejected:(0,s.P1)(n,J),selectIsStopping:(0,s.P1)(n,K),selectIsStopped:(0,s.P1)(n,Y),selectHasResults:(0,s.P1)(n,h),selectHasNoResults:(0,s.P1)(n,B),selectHasError:(0,s.P1)(n,Q),selectErrorMessage:(0,s.P1)(n,V),selectErrorCode:(0,s.P1)(n,W)}:{selectIds:o,selectEntities:c,selectAll:l,selectTotal:u,selectIsInit:f,selectIsLoading:D,selectIsLoadingMore:$,selectIsLoadingOrLoadingMore:R,selectIsProcessing:Z,selectIsResolved:H,selectIsFailed:U,selectIsRejected:J,selectIsStopping:K,selectIsStopped:Y,selectHasResults:h,selectHasNoResults:B,selectHasError:Q,selectErrorMessage:V,selectErrorCode:W}}}}();return{...n,getInitialState:function t(n={}){return Object.assign(function q(){return{ids:[],entities:{},requestState:i.INIT}}(),n)},...o}}({sortComparer:!1}),b=g.getInitialState({requestState:"INIT"}),_=(0,s.Lq)(b,(0,s.on)(S,t=>({...t,requestState:i.LOADING})),(0,s.on)(y,(t,{friends:n})=>g.setAll(n||[],{...t,requestState:i.RESOLVED})),(0,s.on)(A,(t,{error:n})=>({...t,requestState:{errorMsg:n}})),(0,s.on)(E,t=>({...t,requestState:i.LOADING})),(0,s.on)(v,(t,{friend:n})=>g.addOne(n,{...t,requestState:i.RESOLVED})),(0,s.on)(P,(t,{error:n})=>({...t,requestState:{errorMsg:n}}))),T="friendsTracker";function tt(t,n){return(0,s.UY)({[O]:_})(t,n)}const et=(0,s.ZF)(T),nt=(0,s.P1)(et,t=>t[O]),{selectAll:N,selectIsResolved:st,selectErrorMessage:rt,selectIsLoading:ot}=g.getSelectors(nt);var p=a(3837),e=a(4650),M=a(3486),at=a(5412),F=a(1576),it=a(4859),ct=a(3336),dt=a(1572),lt=a(266),ut=a(4332);function ft(t,n){if(1&t&&(e.ynx(0),e.TgZ(1,"h1"),e._uU(2," Sorry! "),e.qZA(),e.TgZ(3,"h3"),e._uU(4),e.qZA(),e.BQk()),2&t){const o=n.ngIf;e.xp6(4),e.Oqu(o)}}function gt(t,n){1&t&&(e.ynx(0),e.TgZ(1,"h2"),e._uU(2,"... Fake loading ..."),e.qZA(),e._UZ(3,"mat-spinner"),e.BQk())}function pt(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"section",6)(1,"app-friends-table",7)(2,"div",8)(3,"button",9),e.NdJ("click",function(){e.CHM(o);const l=e.oxw();return e.KtG(l.addFriend())}),e.TgZ(4,"mat-icon"),e._uU(5,"add"),e.qZA()()()()()}if(2&t){const o=e.oxw();e.xp6(1),e.Q6J("friends",o.friends$)}}let mt=(()=>{class t{constructor(o,c,l){this.friendsService=o,this.dialog=c,this.store=l,this.friends$=this.store.select(N),this.isLoading$=this.store.select(ot),this.isLoaded$=this.store.select(st),this.error$=this.store.select(rt),this.store.dispatch(S())}addFriend(){var o=this;return(0,j.Z)(function*(){const c=yield o.dialog.open(p.VY,{data:{friends$:o.store.select(N)}}).afterClosed().toPromise();!c||o.store.dispatch(E({friend:c}))})()}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(M.l),e.Y36(at.uw),e.Y36(s.yh))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-atomic-state-page"]],decls:11,vars:9,consts:[["fxLayout","column","fxLayoutAlign","start center",1,"container"],["fxLayout","column","fxLayoutAlign","center center",1,"header"],[1,"title--container"],[1,"title--text"],[4,"ngIf"],["class","content","fxLayout","column","fxLayoutAlign","center center",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center",1,"content"],[3,"friends"],[1,"table-actions"],["color","primary","fxFlex","none","mat-mini-fab","","matTooltip","Add Friend","type","button",3,"click"]],template:function(o,c){1&o&&(e.TgZ(0,"div",0)(1,"header",1)(2,"div",2)(3,"h1",3),e._uU(4,"Friends Tracker (Using Atomic State)"),e.qZA()()(),e.YNc(5,ft,5,1,"ng-container",4),e.ALo(6,"async"),e.YNc(7,gt,4,0,"ng-container",4),e.ALo(8,"async"),e.YNc(9,pt,6,1,"section",5),e.ALo(10,"async"),e.qZA()),2&o&&(e.xp6(5),e.Q6J("ngIf",e.lcZ(6,3,c.error$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(8,5,c.isLoading$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(10,7,c.isLoaded$)))},dependencies:[I.O5,F.xw,F.Wh,F.yH,it.lW,ct.Hw,dt.Ou,lt.gM,ut.v,I.Ov]}),t})();var It=a(8252),d=a(493),G=a(9646),At=a(3900),m=a(4004),C=a(262),Pt=a(4351),St=a(7009);let Et=(()=>{class t{constructor(o,c,l){this.actions$=o,this.friendsApiService=c,this.snackBar=l,this.loadFriends$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(S),(0,At.w)(()=>this.friendsApiService.list().pipe((0,m.U)(u=>y({friends:u})),(0,C.K)(()=>(0,G.of)(A({error:"Failed loading the list of friends. Please contact your administrator"}))))))),this.loadFailure$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(A),(0,m.U)(()=>{setTimeout(()=>this.snackBar.open("Error loading friends!","Error",{duration:2500}),0)})),{dispatch:!1}),this.addFriend$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(E),(0,Pt.b)(({friend:u})=>this.friendsApiService.add(u).pipe((0,m.U)(f=>v({friend:f})),(0,C.K)(f=>(0,G.of)(P({error:"Failed adding a friend. Please contact your administrator"}))))))),this.addFriendFailure$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(P),(0,m.U)(()=>{setTimeout(()=>this.snackBar.open("Error adding a friend","Error",{duration:2500}),0)})),{dispatch:!1})}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(d.eX),e.LFG(M.l),e.LFG(St.ux))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),Ft=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[s.Aw.forFeature(T,tt),d.sQ.forFeature([Et])]}),t})();const ht=[{path:"",component:mt}];let Lt=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[I.ez,p.qX,It.Bz.forChild(ht),Ft,p.OJ,p.xA]}),t})()}}]);