"use strict";(self.webpackChunkngrx_example_app=self.webpackChunkngrx_example_app||[]).push([[253],{9253:(lt,P,a)=>{a.r(P),a.d(P,{EntityStateModule:()=>dt});var d=a(6895),E=a(8252),I=a(5861),o=a(9653);const v=(0,o.PH)("[Friends API] Load Success",(0,o.Ky)()),p=(0,o.PH)("[Friends API] Load Failure",(0,o.Ky)()),T=(0,o.PH)("[Friends API] Add Friend Success",(0,o.Ky)()),F=(0,o.PH)("[Friends API] Add Friend Failure",(0,o.Ky)()),m=(0,o.PH)("[Friends Tracker Page] Enter"),y=(0,o.PH)("[Friends Tracker Page] AddFriend",(0,o.Ky)());var Z=a(4629);const A="friends",l=(0,Z.H)({sortComparer:!1}),$=l.getInitialState({callState:"INIT"}),U=(0,o.Lq)($,(0,o.on)(m,t=>({...t,callState:"LOADING"})),(0,o.on)(v,(t,{friends:n})=>l.setAll(n||[],{...t,callState:"LOADED"})),(0,o.on)(p,(t,{error:n})=>({...t,callState:{errorMessage:n}})),(0,o.on)(y,t=>({...t,callState:"LOADING"})),(0,o.on)(T,(t,{friend:n})=>l.addOne(n,{...t,callState:"LOADED"})),(0,o.on)(F,(t,{error:n})=>({...t,callState:{errorMessage:n}}))),M="friendsTracker";function D(t,n){return(0,o.UY)({[A]:U})(t,n)}const G=(0,o.ZF)(M),f=(0,o.P1)(G,t=>t[A]),{selectAll:u}=l.getSelectors(f),K=(0,o.P1)(f,t=>"LOADING"===t.callState),k=(0,o.P1)(f,t=>"LOADED"===t.callState),B=(0,o.P1)(f,t=>function H(t){return void 0!==t.errorMessage?t.errorMessage:null}(t.callState)),J=(0,o.P1)(u,t=>{const n=(new Date).getMonth();return t.filter(r=>r.created.getUTCMonth()===n).length}),N=(0,o.P1)(u,t=>{const n=(new Date).getUTCMonth()-1;return t.filter(r=>r.created.getUTCMonth()===n).length});(0,o.P1)(J,N,(t,n)=>100*t/n);var Y=a(12),e=a(4650),S=a(3486),Q=a(5412),x=a(1576),W=a(4859),z=a(3336),j=a(1572),X=a(266),R=a(4332);function V(t,n){if(1&t&&(e.ynx(0),e.TgZ(1,"h1"),e._uU(2," Sorry! "),e.qZA(),e.TgZ(3,"h3"),e._uU(4),e.qZA(),e.BQk()),2&t){const r=n.ngIf;e.xp6(4),e.Oqu(r)}}function w(t,n){1&t&&(e.ynx(0),e.TgZ(1,"h2"),e._uU(2,"... Fake loading ..."),e.qZA(),e._UZ(3,"mat-spinner"),e.BQk())}function b(t,n){if(1&t){const r=e.EpF();e.TgZ(0,"section",6)(1,"app-friends-table",7)(2,"div",8)(3,"button",9),e.NdJ("click",function(){e.CHM(r);const c=e.oxw();return e.KtG(c.addFriend())}),e.TgZ(4,"mat-icon"),e._uU(5,"add"),e.qZA()()()()()}if(2&t){const r=e.oxw();e.xp6(1),e.Q6J("friends",r.friends$)}}let q=(()=>{class t{constructor(r,i,c){this.friendsService=r,this.dialog=i,this.store=c,this.store.dispatch(m()),this.friends$=this.store.select(u),this.isLoaded$=this.store.select(k),this.isLoading$=this.store.select(K),this.error$=this.store.select(B)}addFriend(){var r=this;return(0,I.Z)(function*(){const i=yield r.dialog.open(Y.V,{data:{friends$:r.store.select(u)}}).afterClosed().toPromise();!i||r.store.dispatch(y({friend:i}))})()}}return t.\u0275fac=function(r){return new(r||t)(e.Y36(S.l),e.Y36(Q.uw),e.Y36(o.yh))},t.\u0275cmp=e.Xpm({type:t,selectors:[["ng-component"]],decls:11,vars:9,consts:[["fxLayout","column","fxLayoutAlign","start center",1,"container"],["fxLayout","column","fxLayoutAlign","center center",1,"header"],[1,"title--container"],[1,"title--text"],[4,"ngIf"],["class","content","fxLayout","column","fxLayoutAlign","center center",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center",1,"content"],[3,"friends"],[1,"table-actions"],["color","primary","fxFlex","none","mat-mini-fab","","matTooltip","Add Friend","type","button",3,"click"]],template:function(r,i){1&r&&(e.TgZ(0,"div",0)(1,"header",1)(2,"div",2)(3,"h1",3),e._uU(4,"Friends Tracker Application"),e.qZA()()(),e.YNc(5,V,5,1,"ng-container",4),e.ALo(6,"async"),e.YNc(7,w,4,0,"ng-container",4),e.ALo(8,"async"),e.YNc(9,b,6,1,"section",5),e.ALo(10,"async"),e.qZA()),2&r&&(e.xp6(5),e.Q6J("ngIf",e.lcZ(6,3,i.error$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(8,5,i.isLoading$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(10,7,i.isLoaded$)))},dependencies:[d.O5,x.xw,x.Wh,x.yH,W.lW,z.Hw,j.Ou,X.gM,R.v,d.Ov],styles:["[_nghost-%COMP%]{display:flex;width:100%;height:100%}.container[_ngcontent-%COMP%]{width:100%;height:100%}.header[_ngcontent-%COMP%]{height:150px;margin-top:40px;padding-bottom:-16px;width:100%}.header[_ngcontent-%COMP%]   .title--container[_ngcontent-%COMP%]{width:100%;max-width:800px;padding:16px}.header[_ngcontent-%COMP%]   .title--text[_ngcontent-%COMP%]{color:#000;padding-left:24px;font-weight:500;font-size:2rem}.content[_ngcontent-%COMP%]{margin-top:-20.88px;max-width:855px}.friends-widget[_ngcontent-%COMP%]{margin-top:30px}"]}),t})();var _=a(2755),tt=a(157),et=a(3837);let nt=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[d.ez,et.qX,_.O,tt.x]}),t})();var s=a(493),L=a(9646),rt=a(3900),g=a(4004),C=a(262),ot=a(4351),at=a(7009);let it=(()=>{class t{constructor(r,i,c){this.actions$=r,this.friendsApiService=i,this.snackBar=c,this.loadFriends$=(0,s.GW)(()=>this.actions$.pipe((0,s.l4)(m),(0,rt.w)(()=>this.friendsApiService.list().pipe((0,g.U)(h=>v({friends:h})),(0,C.K)(h=>(0,L.of)(p({error:"Failed loading the list of friends. Please contact your administrator"}))))))),this.loadFailure$=(0,s.GW)(()=>this.actions$.pipe((0,s.l4)(p),(0,g.U)(()=>{setTimeout(()=>this.snackBar.open("Error loading friends!","Error",{duration:2500}),0)})),{dispatch:!1}),this.addFriend$=(0,s.GW)(()=>this.actions$.pipe((0,s.l4)(y),(0,ot.b)(({friend:h})=>this.friendsApiService.add(h).pipe((0,g.U)(O=>T({friend:O})),(0,C.K)(O=>(0,L.of)(F({error:"Failed adding a friend. Please contact your administrator"}))))))),this.addFriendFailure$=(0,s.GW)(()=>this.actions$.pipe((0,s.l4)(F),(0,g.U)(()=>{setTimeout(()=>this.snackBar.open("Error adding a friend","Error",{duration:2500}),0)})),{dispatch:!1})}}return t.\u0275fac=function(r){return new(r||t)(e.LFG(s.eX),e.LFG(S.l),e.LFG(at.ux))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})(),st=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[o.Aw.forFeature(M,D),s.sQ.forFeature([it])]}),t})();const ct=[{path:"",component:q}];let dt=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[d.ez,E.Bz.forChild(ct),st,nt]}),t})()}}]);